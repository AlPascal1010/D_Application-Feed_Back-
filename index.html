<!DOCTYPE html>
<html>
<head>
    <title>Feedback DApp</title>
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
</head>
<body>
    <h1>Feedback DApp</h1>
    <button id="connectButton">Connect Wallet</button>
    <div id="feedbackForm" style="display: none;">
        <textarea id="feedbackInput"></textarea>
        <button id="sendButton">Send Feedback</button>
    </div>
    <div id="feedbacks"></div>

    <script>
        let web3 = new Web3(window.ethereum);
        let feedbackContract;
        const contractAddress = {
            "_format": "hh-sol-artifact-1",
            "contractName": "Feedback",
            "sourceName": "contracts/Feedback.sol",
            "abi": [
              {
                "inputs": [
                  {
                    "internalType": "uint256",
                    "name": "",
                    "type": "uint256"
                  }
                ],
                "name": "comments",
                "outputs": [
                  {
                    "internalType": "address",
                    "name": "user",
                    "type": "address"
                  },
                  {
                    "internalType": "string",
                    "name": "feedback",
                    "type": "string"
                  }
                ],
                "stateMutability": "view",
                "type": "function"
              },
              {
                "inputs": [
                  {
                    "internalType": "uint256",
                    "name": "_index",
                    "type": "uint256"
                  }
                ],
                "name": "getFeedback",
                "outputs": [
                  {
                    "internalType": "address",
                    "name": "",
                    "type": "address"
                  },
                  {
                    "internalType": "string",
                    "name": "",
                    "type": "string"
                  }
                ],
                "stateMutability": "view",
                "type": "function"
              },
              {
                "inputs": [],
                "name": "getFeedbackCount",
                "outputs": [
                  {
                    "internalType": "uint256",
                    "name": "",
                    "type": "uint256"
                  }
                ],
                "stateMutability": "view",
                "type": "function"
              },
              {
                "inputs": [
                  {
                    "internalType": "string",
                    "name": "_feedback",
                    "type": "string"
                  }
                ],
                "name": "giveFeedback",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
              }
            ],
            "bytecode": "0x608060405234801561001057600080fd5b50610a20806100206000396000f3fe608060405234801561001057600080fd5b506004361061004c5760003560e01c80631106a3821461005157806338c5c86b146100825780638ebb4c15146100a0578063a6102d32146100d1575b600080fd5b61006b60048036038101906100669190610407565b6100ed565b604051610079929190610505565b60405180910390f35b61008a61021d565b6040516100979190610544565b60405180910390f35b6100ba60048036038101906100b59190610407565b610229565b6040516100c8929190610505565b60405180910390f35b6100eb60048036038101906100e69190610694565b610305565b005b600060606000808481548110610106576101056106dd565b5b90600052602060002090600202016040518060400160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020016001820180546101859061073b565b80601f01602080910402602001604051908101604052809291908181526020018280546101b19061073b565b80156101fe5780601f106101d3576101008083540402835291602001916101fe565b820191906000526020600020905b8154815290600101906020018083116101e157829003601f168201915b5050505050815250509050806000015181602001519250925050915091565b60008080549050905090565b6000818154811061023957600080fd5b90600052602060002090600202016000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010180546102829061073b565b80601f01602080910402602001604051908101604052809291908181526020018280546102ae9061073b565b80156102fb5780601f106102d0576101008083540402835291602001916102fb565b820191906000526020600020905b8154815290600101906020018083116102de57829003601f168201915b5050505050905082565b600060405180604001604052803373ffffffffffffffffffffffffffffffffffffffff16815260200183815250908060018154018082558091505060019003906000526020600020906002020160009091909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160010190816103b79190610918565b50505050565b6000604051905090565b600080fd5b600080fd5b6000819050919050565b6103e4816103d1565b81146103ef57600080fd5b50565b600081359050610401816103db565b92915050565b60006020828403121561041d5761041c6103c7565b5b600061042b848285016103f2565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061045f82610434565b9050919050565b61046f81610454565b82525050565b600081519050919050565b600082825260208201905092915050565b60005b838110156104af578082015181840152602081019050610494565b60008484015250505050565b6000601f19601f8301169050919050565b60006104d782610475565b6104e18185610480565b93506104f1818560208601610491565b6104fa816104bb565b840191505092915050565b600060408201905061051a6000830185610466565b818103602083015261052c81846104cc565b90509392505050565b61053e816103d1565b82525050565b60006020820190506105596000830184610535565b92915050565b600080fd5b600080fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6105a1826104bb565b810181811067ffffffffffffffff821117156105c0576105bf610569565b5b80604052505050565b60006105d36103bd565b90506105df8282610598565b919050565b600067ffffffffffffffff8211156105ff576105fe610569565b5b610608826104bb565b9050602081019050919050565b82818337600083830152505050565b6000610637610632846105e4565b6105c9565b90508281526020810184848401111561065357610652610564565b5b61065e848285610615565b509392505050565b600082601f83011261067b5761067a61055f565b5b813561068b848260208601610624565b91505092915050565b6000602082840312156106aa576106a96103c7565b5b600082013567ffffffffffffffff8111156106c8576106c76103cc565b5b6106d484828501610666565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b6000600282049050600182168061075357607f821691505b6020821081036107665761076561070c565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b6000600883026107ce7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82610791565b6107d88683610791565b95508019841693508086168417925050509392505050565b6000819050919050565b600061081561081061080b846103d1565b6107f0565b6103d1565b9050919050565b6000819050919050565b61082f836107fa565b61084361083b8261081c565b84845461079e565b825550505050565b600090565b61085861084b565b610863818484610826565b505050565b5b818110156108875761087c600082610850565b600181019050610869565b5050565b601f8211156108cc5761089d8161076c565b6108a684610781565b810160208510156108b5578190505b6108c96108c185610781565b830182610868565b50505b505050565b600082821c905092915050565b60006108ef600019846008026108d1565b1980831691505092915050565b600061090883836108de565b9150826002028217905092915050565b61092182610475565b67ffffffffffffffff81111561093a57610939610569565b5b610944825461073b565b61094f82828561088b565b600060209050601f8311600181146109825760008415610970578287015190505b61097a85826108fc565b8655506109e2565b601f1984166109908661076c565b60005b828110156109b857848901518255600182019150602085019450602081019050610993565b868310156109d557848901516109d1601f8916826108de565b8355505b6001600288020188555050505b50505050505056fea264697066735822122059826c3acf8cb5aa16d0ebca8ab690ad5ceaa4fc7c68959bd85b9c24009cebb664736f6c63430008180033",
            "deployedBytecode": "0x608060405234801561001057600080fd5b506004361061004c5760003560e01c80631106a3821461005157806338c5c86b146100825780638ebb4c15146100a0578063a6102d32146100d1575b600080fd5b61006b60048036038101906100669190610407565b6100ed565b604051610079929190610505565b60405180910390f35b61008a61021d565b6040516100979190610544565b60405180910390f35b6100ba60048036038101906100b59190610407565b610229565b6040516100c8929190610505565b60405180910390f35b6100eb60048036038101906100e69190610694565b610305565b005b600060606000808481548110610106576101056106dd565b5b90600052602060002090600202016040518060400160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020016001820180546101859061073b565b80601f01602080910402602001604051908101604052809291908181526020018280546101b19061073b565b80156101fe5780601f106101d3576101008083540402835291602001916101fe565b820191906000526020600020905b8154815290600101906020018083116101e157829003601f168201915b5050505050815250509050806000015181602001519250925050915091565b60008080549050905090565b6000818154811061023957600080fd5b90600052602060002090600202016000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010180546102829061073b565b80601f01602080910402602001604051908101604052809291908181526020018280546102ae9061073b565b80156102fb5780601f106102d0576101008083540402835291602001916102fb565b820191906000526020600020905b8154815290600101906020018083116102de57829003601f168201915b5050505050905082565b600060405180604001604052803373ffffffffffffffffffffffffffffffffffffffff16815260200183815250908060018154018082558091505060019003906000526020600020906002020160009091909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160010190816103b79190610918565b50505050565b6000604051905090565b600080fd5b600080fd5b6000819050919050565b6103e4816103d1565b81146103ef57600080fd5b50565b600081359050610401816103db565b92915050565b60006020828403121561041d5761041c6103c7565b5b600061042b848285016103f2565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061045f82610434565b9050919050565b61046f81610454565b82525050565b600081519050919050565b600082825260208201905092915050565b60005b838110156104af578082015181840152602081019050610494565b60008484015250505050565b6000601f19601f8301169050919050565b60006104d782610475565b6104e18185610480565b93506104f1818560208601610491565b6104fa816104bb565b840191505092915050565b600060408201905061051a6000830185610466565b818103602083015261052c81846104cc565b90509392505050565b61053e816103d1565b82525050565b60006020820190506105596000830184610535565b92915050565b600080fd5b600080fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6105a1826104bb565b810181811067ffffffffffffffff821117156105c0576105bf610569565b5b80604052505050565b60006105d36103bd565b90506105df8282610598565b919050565b600067ffffffffffffffff8211156105ff576105fe610569565b5b610608826104bb565b9050602081019050919050565b82818337600083830152505050565b6000610637610632846105e4565b6105c9565b90508281526020810184848401111561065357610652610564565b5b61065e848285610615565b509392505050565b600082601f83011261067b5761067a61055f565b5b813561068b848260208601610624565b91505092915050565b6000602082840312156106aa576106a96103c7565b5b600082013567ffffffffffffffff8111156106c8576106c76103cc565b5b6106d484828501610666565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b6000600282049050600182168061075357607f821691505b6020821081036107665761076561070c565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b6000600883026107ce7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82610791565b6107d88683610791565b95508019841693508086168417925050509392505050565b6000819050919050565b600061081561081061080b846103d1565b6107f0565b6103d1565b9050919050565b6000819050919050565b61082f836107fa565b61084361083b8261081c565b84845461079e565b825550505050565b600090565b61085861084b565b610863818484610826565b505050565b5b818110156108875761087c600082610850565b600181019050610869565b5050565b601f8211156108cc5761089d8161076c565b6108a684610781565b810160208510156108b5578190505b6108c96108c185610781565b830182610868565b50505b505050565b600082821c905092915050565b60006108ef600019846008026108d1565b1980831691505092915050565b600061090883836108de565b9150826002028217905092915050565b61092182610475565b67ffffffffffffffff81111561093a57610939610569565b5b610944825461073b565b61094f82828561088b565b600060209050601f8311600181146109825760008415610970578287015190505b61097a85826108fc565b8655506109e2565b601f1984166109908661076c565b60005b828110156109b857848901518255600182019150602085019450602081019050610993565b868310156109d557848901516109d1601f8916826108de565b8355505b6001600288020188555050505b50505050505056fea264697066735822122059826c3acf8cb5aa16d0ebca8ab690ad5ceaa4fc7c68959bd85b9c24009cebb664736f6c63430008180033",
            "linkReferences": {},
            "deployedLinkReferences": {}
          };
        const contractABI = [{
            "inputs": [
            {
              "inputs": [
                {
                  "internalType": "uint256",
                  "name": "",
                  "type": "uint256"
                }
              ],
              "name": "comments",
              "outputs": [
                {
                  "internalType": "address",
                  "name": "user",
                  "type": "address"
                },
                {
                  "internalType": "string",
                  "name": "feedback",
                  "type": "string"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "uint256",
                  "name": "_index",
                  "type": "uint256"
                }
              ],
              "name": "getFeedback",
              "outputs": [
                {
                  "internalType": "address",
                  "name": "",
                  "type": "address"
                },
                {
                  "internalType": "string",
                  "name": "",
                  "type": "string"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [],
              "name": "getFeedbackCount",
              "outputs": [
                {
                  "internalType": "uint256",
                  "name": "",
                  "type": "uint256"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "string",
                  "name": "_feedback",
                  "type": "string"
                }
              ],
              "name": "giveFeedback",
              "outputs": [],
              "stateMutability": "nonpayable",
              "type": "function"
            }
          ];

        document.getElementById('connectButton').addEventListener('click', async () => {
            const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
            feedbackContract = new web3.eth.Contract(contractABI, contractAddress, { from: accounts[0] });
            document.getElementById('feedbackForm').style.display = 'block';
        });

        document.getElementById('sendButton').addEventListener('click', async () => {
            const feedback = document.getElementById('feedbackInput').value;
            await feedbackContract.methods.giveFeedback(feedback).send();
            loadFeedbacks();
        });

        async function loadFeedbacks() {
            const feedbackCount = await feedbackContract.methods.getFeedbackCount().call();
            const feedbacksDiv = document.getElementById('feedbacks');
            feedbacksDiv.innerHTML = '';
            for (let i = 0; i < feedbackCount; i++) {
                const feedback = await feedbackContract.methods.getFeedback(i).call();
                feedbacksDiv.innerHTML += `<p><strong>${feedback[0]}</strong>: ${feedback[1]}</p>`;
            }
        }
    </script>
</body>
</html>